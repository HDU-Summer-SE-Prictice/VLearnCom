<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments :: head(~{::title},~{},~{})">
    <title>讨论区</title>
</head>

<body>
<nav th:replace="fragments :: navigator"></nav>

<div class="container layout layout-margin-top">
    <div class="row">
        <div class="col-md-9 layout-body">
            <div class="content">
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active">
                        <ul class="row question-items">
                            <li class="question-item" th:each="quest:${questions}">
                                <div class="col-md-10">
                                    <div class="col-sm-2 question-item-author">
                                        <div class="user-avatar" th:object="${quest.author}">
                                            <a class="avatar" th:href="'/user/' + *{id}"
                                               target="_blank">
                                                <img th:src="*{headicon}">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-sm-10">
                                        <h4>
                                            <a class="question-item-title" th:href="'/questions/show/' + ${quest.id}"
                                               target="_blank" th:text="${quest.title}"></a>
                                        </h4>
                                        <div class="question-item-summary">
                                            <div class="user-username" th:object="${quest.author}">
                                                <a class="avatar" th:href="'/user/' + *{id}"
                                                   target="_blank"
                                                   th:text="*{username}">
                                                </a>
                                                <span class="user-level" th:text="*{level}"></span>
                                            </div>

                                            <span th:if="${quest.answers.size()>0}" class="question-item-date"
                                                  th:text="${quest.answers[quest.answers.size()-1].birth}">3小时前</span>
                                            最后回复
                                            <span class="question-item-date" th:if="${quest.answers.size()>0}"
                                                  th:object="${quest.answers[quest.answers.size()-1].author}">
                                                <div class="user-username">
                                                    <a class="username" th:href="'/user/' + *{id}" target="_blank"
                                                       th:text="*{username}">
                                                    </a>
                                                    <span class="user-level" th:text="*{level}"></span>
                                                </div>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 question-item-rank">
                                    <div class="question-item-answered">
                                        <div th:text="${quest.answers.size()}">89</div>
                                        <div>回复</div>
                                    </div>
                                    <div class="question-item-views">
                                        <div th:text="${quest.nview}">2409</div>
                                        <div>查看</div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 layout-side">
            <div class="panel panel-default panel-userinfo">
                <div class="panel-body body-userinfo">
                    <div class="media userinfo-header">
                        <div class="media-left">
                            <div class="user-avatar">
                                <a class="avatar" href="/login">
                                    <img class="circle" src="../img/logo-grey.png">
                                </a>
                            </div>
                        </div>
                        <div class="media-body">
                            <span class="media-heading username">欢迎来到 V Learn</span>
                            <p class="vip-remain">专业互联网学习社区</p>
                        </div>
                    </div>

                    <div class="row userinfo-data">
                        <hr>
                        <div class="btn-group-lr" th:unless="${#httpServletRequest.remoteUser}">
                            <a href="/login" type="button" class="btn btn-success col-md-5 col-xs-6 login-btn">登录</a>
                            <a href="/register" type="button"
                               class="btn btn-success col-md-5 col-xs-6 col-md-offset-1 register-btn">注册</a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="container" th:if="${#httpServletRequest.remoteUser}">
    <p><span class="glyphicon glyphicon-pencil"></span>发表新帖</p>
    <form class="form-horizontal" action="/questions/add" method="post">
        <div class="form-group">
            <label class="col-md-2 control-label">标题</label>
            <div class="col-md-10">
                <input type="text" name="title" min="5" max="100" class="form-control" placeholder="至少输入5个字"
                       value="">
                <span class="help-block"></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-md-2 control-label">描述</label>
            <div class="col-md-10">
                <textarea name="content" rows="25" cols="120"></textarea>
            </div>
        </div>
        <div class="form-group">
            <div class="input-group-sm col-md-4 col-md-offset-2 col-xs-12 ">
                <button type="submit" class="btn btn-primary btn-block">发表</button>
            </div>
        </div>
    </form>
</div>

<script src="../app/dest/lib/lib.js?=2016121272249"></script>
<script src="../static/jquery/2.2.4/jquery.min.js"></script>
<script src="../static/ace/1.2.5/ace.js"></script>
<script src="../static/aliyun/aliyun-oss-sdk-4.3.0.min.js"></script>
<script src="../static/highlight.js/9.8.0/highlight.min.js"></script>
<script src="../static/jspdf/1.2.61/jspdf.min.js"></script>
<script src="../static/plupload/2.1.9/js/plupload.full.min.js"></script>
<script src="../static/zeroclipboard/2.2.0/ZeroClipboard.min.js"></script>
<script src="../static/videojs/video.min.js"></script>
<script src="../static/bootstrap-tour/0.11.0/js/bootstrap-tour.min.js"></script>
<script src="../static/bootstrap-table/1.11.0/bootstrap-table.min.js"></script>
<script src="../static/bootstrap-table/1.11.0/locale/bootstrap-table-zh-CN.min.js"></script>
<script src="../static/bootstrap-table/1.11.0/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>

<script src="../static/ravenjs/3.7.0/raven.min.js"></script>
<script>
    Raven.config('https://bc3878b7ed0a4468a65390bd79e6e73f@sentry.xxxxxx.com/5', {
        release: '3.12.13'
    }).install();
</script>

<div th:replace="fragments :: footer"></div>
</body>
</html>
